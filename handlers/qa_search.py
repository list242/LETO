import re

# Здесь будет текст правил. Пока заглушка.
RULES_TEXT = """
1. Быть внимательным и собранным
2. Движение осуществлять СТРОГО ПО МАРШРУТУ (см.Пункт.3)
3. Выполнять все просьбы инструктора, строго подчиняться всем его указаниям в том
числе во время подхода, отхода от причала, маневрировании.
4. Располагаться в лодке только на штатных сиденьях (для достижения баланса)
5. Движение маломерных моторных судов возле пляжей, сап-бордов, рядом со знаком
"не создавать волнение" составляет 5 км/ч.
6. Соблюдать скоростное ограничение, не превышающее 15 км/ч.
7. Соблюдать правостороннее движение, не пересекать реку насквозь, не выходить
на встречное движение, не пересекать курс другим судам.
8. Двигаться между берегом и буем (красным или белым) (вне судового хода)
9. Если крупное (и любое другое судно) разворачивается, необходимо соблюдать
максимальную дистанцию, по необходимости, остановиться и закончить маневр
10. Разворачиваться разрешается при условии отсутствия на судовом ходу любых
других судов (сохранять дистанцию до них не менее 500 метров). Обязательно
убедиться в отсутствии идущих СЗАДИ судов.
11. Расхождение со встречными судами по возможности выполнять левыми бортами
(уходить правее) и НЕ ПЕРЕСЕКАТЬ курс встречного судна
12. Запрещается обгонять другие суда под мостами и в узких местах реки. В таком
случае вы не имеете преимущества и обязаны уступать всем.
13. При прохождении встречной волны - заблаговременно снизить скорость и
направить нос катера под прямым углом к волне.
14. Попутную волну (волна, идущая по направлению вашего движения) проходить на
скорости, превышающей скорость волны.
15. Категорически запрещено проходить встречную волну на большой скорости.
16. Боковую волну проходить, немного развернув носом катер в сторону волны и
увеличив скорость.
17. Запрещено подходить к другим судам ближе, чем на 30 метров, а к КРУПНЫМ
(теплоходы) ближе, чем на 100 метров. В противном случае маломерное судно
может затянуть под КРУПНОЕ судно!
18. При прохождении рядом с БУКСИРОВЩИКАМИ ВЕЙКЕРОВ помните, они имеют
преимущество при движении. Необходимо держать дистанцию не меньше, чем
100 метров, чтобы не столкнуться с человеком, находящимся за катером.
19. Держать телефон при себе в зоне видимости и слышимости. В случае, если
арендатор не ответил на 3 вызова от инструктора подряд, подразумевается, что
Арендатор попал в аварийную ситуацию. В таком случае Инструктор выезжает на
место, обозначенное как местоположение по GPS метке.
20. Судоводитель несет ответственность за соблюдение настоящих Правил движения и
управления судном.
21. При требовании инспектора ГИМС остановиться, выполнить все требования
сотрудников, позвонить инструктору.

Внезапная потеря мощности мотора:
1. Позвонить инструктору.
2. Включить заднюю передачу для самоочистки винта.
Наезд на мель

1. Позвонить инструктору.
2. Быть готовым к экстренному покиданию судна.
3. Нажать кнопку включения помпы (центральная кнопка на панели приборов).
4. Ожидать приезда инструктора.

Столкновение с другим судном
1. Быть готовым к экстренному покиданию судна
2. Покинуть судовой ход - двигаться к берегу
3. Поставить двигатель в положение «нейтраль»
4. Позвонить инструктору

Остановка по требованию ГИМС
1. Позвонить инструктору
2. Выполнить все требования инспектора
3. Вести себя вежливо

Столкновение с подводным объектом
1. Позвонить инструктору
2. Быть готовым к экстренному покиданию судна
3. Нажать кнопку включения помпы (центральная кнопка на панели приборов)
4. Двигаться в сторону берега, ожидать приезда инструктора

2.в случае аварийной или нештатной ситуации
Позвонить инструктору, описать ситуацию и сообщить свое местоположение. Строго
следовать инструкции инструктора.

Внезапная остановка мотора:
1. Позвонить инструктору.
2. Поставить ручку газ - реверс в положение «нейтраль».
"""

def search_answer(question: str) -> str:
    keywords = re.findall(r'\w+', question.lower())
    matches = []

    for paragraph in RULES_TEXT.split('\n\n'):
        score = sum(1 for word in keywords if word in paragraph.lower())
        if score > 0:
            matches.append((score, paragraph))

    if not matches:
        return "Извините, я не нашёл ответа на этот вопрос в правилах."

    matches.sort(reverse=True)
    return matches[0][1][:1000]  # ограничим длину ответа
